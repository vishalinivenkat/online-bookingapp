{"version":3,"file":"src_app_pages_profile_profile_module_ts.js","mappings":";;;;;;;;;;;;;;;;AACuD;AAEV;;;AAE7C,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,sDAAW;KACvB;CACF,CAAC;AAMK,MAAM,wBAAwB;;gGAAxB,wBAAwB;qHAAxB,wBAAwB;yHAHzB,kEAAqB,CAAC,MAAM,CAAC,EAC7B,yDAAY;mIAEX,wBAAwB,oFAFzB,yDAAY;;;;;;;;;;;;;;;;;;;;;ACbuB;AACF;AAEA;AACQ;AAGe;AAEvB;;AAYtC,MAAM,iBAAiB;;kFAAjB,iBAAiB;8GAAjB,iBAAiB;kHAR1B,yDAAY;QACZ,uDAAW;QACX,uDAAW;QACX,+DAAmB;QACnB,6EAAwB;mIAIf,iBAAiB,mBAFb,sDAAW,aANxB,yDAAY;QACZ,uDAAW;QACX,uDAAW;QACX,+DAAmB;QACnB,6EAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjB5B;AAEA;AAIA;;;;;;;;;;;;ICaQK,uDAAAA;;;;;IAAqDA,wDAAAA,8BAAAA,2DAAAA;;;;;;IAEnDA,4DAAAA,eAAsB,CAAtB,EAAsB,GAAtB;IACKA,oDAAAA;IAAaA,0DAAAA;;;;;;;;IAN1BA,4DAAAA,WAAgC,CAAhC,EAAgC,KAAhC,EAAgC,CAAhC,EAAgC,CAAhC,EAAgC,YAAhC,EAAgC,CAAhC;IAEgBA,wDAAAA;MAAAA,2DAAAA;MAAA;MAAA,OAASA,yDAAAA,wCAAT;IAAwC,CAAxC;IACVA,wDAAAA;IACAA,wDAAAA,8EAAAA,oEAAAA;IAKFA,0DAAAA;IAGFA,4DAAAA,gBAAgC,CAAhC,EAAgC,UAAhC,EAAgC,EAAhC;IAEIA,uDAAAA;IACAA,4DAAAA;IACEA,oDAAAA;IACFA,0DAAAA;IAGFA,4DAAAA;IACEA,uDAAAA,qBAAgE,EAAhE,EAAgE,WAAhE,EAAgE,EAAhE;IAEFA,0DAAAA;IAEAA,4DAAAA;IACEA,uDAAAA;IACAA,4DAAAA;IACEA,oDAAAA;IACFA,0DAAAA;IAIJA,4DAAAA,sBAAmE,EAAnE,EAAmE,GAAnE;IACKA,oDAAAA;IAAyCA,0DAAAA;;;;;;;IA/BpCA,uDAAAA;IAAAA,wDAAAA,+BAAqB,UAArB,EAAqBC,GAArB;IASJD,uDAAAA;IAAAA,wDAAAA;IAIAA,uDAAAA;IAAAA,gEAAAA;IAYAA,uDAAAA;IAAAA,gEAAAA;;;;;;IAWNA,uDAAAA;IACAA,4DAAAA;IAAGA,oDAAAA;IAAkBA,0DAAAA;;;;AD1CnB,MAAOE,WAAP,CAAkB;EAKtBC,YACSC,aADT,EAEUC,WAFV,EAGUC,MAHV,EAIUC,iBAJV,EAKUC,eALV,EAMUC,IANV,EAOUC,qBAPV,EAQUC,EARV,EAQyB;IAAA;;IAPhB;IACC;IACA;IACA;IACA;IACA;IACA;IACA;IAER,KAAKF,IAAL,CAAUG,kBAAV;MAAA,6LAA6B,WAAOC,IAAP,EAAe;QAC1C,IAAIA,IAAJ,EAAU;UACR,KAAI,CAACA,IAAL,GAAYA,IAAZ;;UACA,KAAI,CAACC,WAAL,CAAiBC,UAAjB,CAA4B;YAC1BC,WAAW,EAAEH,IAAI,CAACG,WAAL,IAAoB;UADP,CAA5B;;UAGA,KAAI,CAACZ,aAAL,CAAmBa,OAAnB,GAA6BJ,IAA7B,CALQ,CAK2B;QACpC;MACF,CARD;;MAAA;QAAA;MAAA;IAAA;EASD;;EAEDK,QAAQ;IACNC,OAAO,CAACC,GAAR,CAAY,yBAAZ;IACA,KAAKN,WAAL,GAAmB,KAAKH,EAAL,CAAQU,KAAR,CAAc;MAC/BL,WAAW,EAAE,CAAC,EAAD;IADkB,CAAd,CAAnB;IAIA,KAAKF,WAAL,CAAiBQ,GAAjB,CAAqB,aAArB,EAAoCC,YAApC,CAAiDC,SAAjD,CAA2DC,KAAK,IAAG;MACjE,KAAKC,WAAL;IACD,CAFD;EAGD;;EAEDC,WAAW;IACTR,OAAO,CAACC,GAAR,CAAY,uBAAZ,EADS,CAET;EACD;;EAEKQ,MAAM;IAAA;;IAAA;MACV,MAAM,MAAI,CAACvB,WAAL,CAAiBuB,MAAjB,EAAN;;MACA,MAAI,CAACtB,MAAL,CAAYuB,aAAZ,CAA0B,GAA1B,EAA+B;QAAEC,UAAU,EAAE;MAAd,CAA/B;IAFU;EAGX;;EAEDC,MAAM;IACJ;IACA,KAAKzB,MAAL,CAAY0B,QAAZ,CAAqB,CAAC,OAAD,CAArB,EAFI,CAE6B;EAClC;;EAEKC,6BAA6B;IAAA;;IAAA;MACjC,MAAMC,WAAW,SAAS,MAAI,CAACxB,qBAAL,CAA2ByB,MAA3B,CAAkC;QAC1DC,MAAM,EAAE,qBADkD;QAE1DC,OAAO,EAAE,CACP;UACEC,IAAI,EAAE,QADR;UAEEC,IAAI,EAAE,QAFR;UAGEC,OAAO,EAAE,MAAK;YACZ,MAAI,CAACC,WAAL,CAAiB3C,kEAAjB;UACD;QALH,CADO,EAQP;UACEwC,IAAI,EAAE,SADR;UAEEC,IAAI,EAAE,QAFR;UAGEC,OAAO,EAAE,MAAK;YACZ,MAAI,CAACC,WAAL,CAAiB3C,kEAAjB;UACD;QALH,CARO,EAeP;UACEwC,IAAI,EAAE,MADR;UAEEC,IAAI,EAAE,UAFR;UAGEC,OAAO,EAAE,MAAK;YACZ,MAAI,CAACG,UAAL;UACD;QALH,CAfO,EAsBP;UACEL,IAAI,EAAE,QADR;UAEEC,IAAI,EAAE,OAFR;UAGEK,IAAI,EAAE;QAHR,CAtBO;MAFiD,CAAlC,CAA1B;MA+BA,MAAMV,WAAW,CAACW,OAAZ,EAAN;IAhCiC;EAiClC;;EAEKJ,WAAW,CAACK,MAAD,EAAqB;IAAA;;IAAA;MACpC,IAAI;QACF,MAAMC,KAAK,SAASnD,8DAAA,CAAgB;UAClCqD,OAAO,EAAE,EADyB;UAElCC,YAAY,EAAE,KAFoB;UAGlCC,UAAU,EAAEtD,sEAHsB;UAIlCiD,MAAM,EAAEA;QAJ0B,CAAhB,CAApB;;QAOA,IAAIC,KAAJ,EAAW;UACT,MAAMM,OAAO,SAAS,MAAI,CAAC9C,iBAAL,CAAuB4B,MAAvB,EAAtB;UACA,MAAMkB,OAAO,CAACR,OAAR,EAAN;;UAEA,IAAI,CAAC,MAAI,CAACzC,aAAL,CAAmBa,OAAnB,EAA4BqC,GAAjC,EAAsC;YACpCD,OAAO,CAACE,OAAR;YACA,MAAMC,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;cAC9CC,MAAM,EAAE,eADsC;cAE9CqB,OAAO,EAAE,yBAFqC;cAG9CpB,OAAO,EAAE,CAAC,IAAD;YAHqC,CAA5B,CAApB;YAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN;YACA;UACD;;UAED,MAAMa,MAAM,SAAS,MAAI,CAACtD,aAAL,CAAmBuD,WAAnB,CAA+BZ,KAA/B,EAAsC,MAAI,CAAC3C,aAAL,CAAmBa,OAAnB,CAA2BqC,GAAjE,CAArB;UACAD,OAAO,CAACE,OAAR;;UAEA,IAAI,CAACG,MAAL,EAAa;YACX,MAAMF,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;cAC9CC,MAAM,EAAE,eADsC;cAE9CqB,OAAO,EAAE,4CAFqC;cAG9CpB,OAAO,EAAE,CAAC,IAAD;YAHqC,CAA5B,CAApB;YAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN;UACD,CAPD,MAOO;YACL,MAAMW,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;cAC9CC,MAAM,EAAE,mBADsC;cAE9CqB,OAAO,EAAE,6CAFqC;cAG9CpB,OAAO,EAAE,CAAC,IAAD;YAHqC,CAA5B,CAApB;YAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN,CANK,CAQL;;YACA,IAAI,MAAI,CAACpC,IAAL,CAAUmD,WAAd,EAA2B;cACzB,MAAMF,MAAM,SAAS,MAAI,CAACtD,aAAL,CAAmBuD,WAAnB,CAA+BZ,KAA/B,EAA+C,MAAI,CAAC3C,aAAL,CAAmBa,OAAnB,CAA2BqC,GAA1E,CAArB;cACA,MAAM3D,iEAAa,CAAC,MAAI,CAACkB,IAAN,EAAY;gBAC7BgD,QAAQ,EAAEH;cADmB,CAAZ,CAAnB;cAGA,MAAI,CAAC7C,IAAL,GAAY,MAAI,CAACJ,IAAL,CAAUmD,WAAtB,CALyB,CAKU;YACpC;UACF;QACF;MACF,CAnDD,CAmDE,OAAOE,KAAP,EAAc;QACd,MAAMN,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;UAC9CC,MAAM,EAAE,eADsC;UAE9CqB,OAAO,EAAE,8CAA8CK,KAAK,CAACL,OAAO,EAFtB;UAG9CpB,OAAO,EAAE,CAAC,IAAD;QAHqC,CAA5B,CAApB;QAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN;MACD;IA3DmC;EA4DrC;;EAEKF,UAAU;IAAA;;IAAA;MACd,MAAMoB,KAAK,GAAGC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAd;MACAF,KAAK,CAACG,IAAN,GAAa,MAAb;MACAH,KAAK,CAACI,MAAN,GAAe,SAAf;;MACAJ,KAAK,CAACK,QAAN;QAAA,8LAAiB,WAAOC,KAAP,EAAqB;UACpC,MAAMC,IAAI,GAAGD,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAb;;UACA,IAAIF,IAAJ,EAAU;YACR,MAAMG,MAAM,GAAG,IAAIC,UAAJ,EAAf;;YACAD,MAAM,CAACE,MAAP;cAAA,8LAAgB,WAAOC,CAAP,EAAiB;gBAC/B,MAAM7B,KAAK,GAAG;kBACZ8B,YAAY,EAAED,CAAC,CAACL,MAAF,CAASb,MAAT,CAAgBoB,KAAhB,CAAsB,GAAtB,EAA2B,CAA3B;gBADF,CAAd;gBAGA,MAAMzB,OAAO,SAAS,MAAI,CAAC9C,iBAAL,CAAuB4B,MAAvB,EAAtB;gBACA,MAAMkB,OAAO,CAACR,OAAR,EAAN;;gBAEA,IAAI,CAAC,MAAI,CAACzC,aAAL,CAAmBa,OAAnB,EAA4BqC,GAAjC,EAAsC;kBACpCD,OAAO,CAACE,OAAR;kBACA,MAAMC,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;oBAC9CC,MAAM,EAAE,eADsC;oBAE9CqB,OAAO,EAAE,yBAFqC;oBAG9CpB,OAAO,EAAE,CAAC,IAAD;kBAHqC,CAA5B,CAApB;kBAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN;kBACA;gBACD;;gBAED,MAAMa,MAAM,SAAS,MAAI,CAACtD,aAAL,CAAmBuD,WAAnB,CAA+BZ,KAA/B,EAA+C,MAAI,CAAC3C,aAAL,CAAmBa,OAAnB,CAA2BqC,GAA1E,CAArB;gBACAD,OAAO,CAACE,OAAR;;gBAEA,IAAI,CAACG,MAAL,EAAa;kBACX,MAAMF,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;oBAC9CC,MAAM,EAAE,eADsC;oBAE9CqB,OAAO,EAAE,4CAFqC;oBAG9CpB,OAAO,EAAE,CAAC,IAAD;kBAHqC,CAA5B,CAApB;kBAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN;gBACD,CAPD,MAOO;kBACL,MAAMW,KAAK,SAAS,MAAI,CAAChD,eAAL,CAAqB2B,MAArB,CAA4B;oBAC9CC,MAAM,EAAE,mBADsC;oBAE9CqB,OAAO,EAAE,6CAFqC;oBAG9CpB,OAAO,EAAE,CAAC,IAAD;kBAHqC,CAA5B,CAApB;kBAKA,MAAMmB,KAAK,CAACX,OAAN,EAAN,CANK,CAQL;;kBACA,IAAI,MAAI,CAACpC,IAAL,CAAUmD,WAAd,EAA2B;oBACzB,MAAMjE,iEAAa,CAAC,MAAI,CAACkB,IAAN,EAAY;sBAC7BgD,QAAQ,EAAEH;oBADmB,CAAZ,CAAnB;oBAGA,MAAI,CAAC7C,IAAL,GAAY,MAAI,CAACJ,IAAL,CAAUmD,WAAtB,CAJyB,CAIU;kBACpC;gBACF;cACF,CA5CD;;cAAA;gBAAA;cAAA;YAAA;;YA6CAa,MAAM,CAACM,aAAP,CAAqBT,IAArB;UACD;QACF,CAnDD;;QAAA;UAAA;QAAA;MAAA;;MAoDAP,KAAK,CAACiB,KAAN;IAxDc;EAyDf;;EAEKtD,WAAW;IAAA;;IAAA;MACf,IAAI,MAAI,CAACb,IAAT,EAAe;QACb,MAAMoE,UAAU,GAAGlF,4DAAG,CAAC,MAAI,CAACK,aAAL,CAAmB8E,SAApB,EAA+B,UAAU,MAAI,CAACrE,IAAL,CAAUyC,GAAG,EAAtD,CAAtB,CADa,CAEb;QACA;;QAEA,IAAI;UACF,MAAM3D,iEAAa,CAAC,MAAI,CAACkB,IAAN,EAAY;YAC7BG,WAAW,EAAE,MAAI,CAACF,WAAL,CAAiBQ,GAAjB,CAAqB,aAArB,EAAoCG;UADpB,CAAZ,CAAnB,CADE,CAIF;UACA;UACA;UACA;UACA;UACA;UACA;QACD,CAXD,CAWE,OAAOqC,KAAP,EAAc,CACd;UACA;UACA;UACA;UACA;UACA;UACA;QACD;MACF;IA1Bc;EA2BhB;;AA3OqB;;;mBAAX5D,aAAWF,+DAAAA,CAAAA,0EAAAA,GAAAA,+DAAAA,CAAAA,sEAAAA,GAAAA,+DAAAA,CAAAA,mDAAAA,GAAAA,+DAAAA,CAAAA,6DAAAA,GAAAA,+DAAAA,CAAAA,2DAAAA,GAAAA,+DAAAA,CAAAA,oDAAAA,GAAAA,+DAAAA,CAAAA,iEAAAA,GAAAA,+DAAAA,CAAAA,uDAAAA;AAAA;;;QAAXE;EAAWiF;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCfxBvF,4DAAAA,qBAAkC,CAAlC,EAAkC,aAAlC,EAAkC,CAAlC,EAAkC,aAAlC,EAAkC,CAAlC,EAAkC,CAAlC,EAAkC,YAAlC,EAAkC,CAAlC;MAGkCA,wDAAAA;QAAA,OAASwF,YAAT;MAAiB,CAAjB;MAC1BxF,uDAAAA;MACFA,0DAAAA;MAEFA,4DAAAA,sBAAwB,CAAxB,EAAwB,YAAxB,EAAwB,CAAxB;MACcA,wDAAAA;QAAA,OAASwF,YAAT;MAAiB,CAAjB;MACVxF,uDAAAA;MACFA,0DAAAA;MAEFA,4DAAAA;MAAWA,oDAAAA;MAAUA,0DAAAA;MAIzBA,4DAAAA;MACEA,wDAAAA;MAsCAA,wDAAAA,wEAAAA,oEAAAA;MAIFA,0DAAAA;;;;;;MA1CQA,uDAAAA;MAAAA,wDAAAA,mBAAY,UAAZ,EAAYyF,GAAZ","sources":["./src/app/pages/profile/profile-routing.module.ts","./src/app/pages/profile/profile.module.ts","./src/app/pages/profile/profile.page.ts","./src/app/pages/profile/profile.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProfilePage } from './profile.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfilePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfilePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n\nimport { ProfilePageRoutingModule } from './profile-routing.module';\n\nimport { ProfilePage } from './profile.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReactiveFormsModule,\n    ProfilePageRoutingModule\n  ],\n  declarations: [ProfilePage]\n})\nexport class ProfilePageModule {}\n","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Auth, updateProfile } from '@angular/fire/auth';\nimport { Router } from '@angular/router';\nimport { Camera, CameraResultType, CameraSource, Photo } from '@capacitor/camera';\nimport { LoadingController, AlertController, ActionSheetController } from '@ionic/angular';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { AvatarService } from 'src/app/services/avatar.service';\nimport { doc } from '@angular/fire/firestore';\nimport { FormBuilder, FormGroup } from '@angular/forms';\n\n@Component({\n  selector: 'app-profile',\n  templateUrl: './profile.page.html',\n  styleUrls: ['./profile.page.scss'],\n})\nexport class ProfilePage implements OnInit, OnDestroy {\n\n  profileForm: FormGroup;\n  user: import(\"@angular/fire/auth\").User;\n\n  constructor(\n    public avatarService: AvatarService,\n    private authService: AuthService,\n    private router: Router,\n    private loadingController: LoadingController,\n    private alertController: AlertController,\n    private auth: Auth,\n    private actionSheetController: ActionSheetController,\n    private fb: FormBuilder\n  ) {\n    this.auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        this.user = user;\n        this.profileForm.patchValue({\n          displayName: user.displayName || '',\n        });\n        this.avatarService.profile = user; // Ensure the profile is set\n      }\n    });\n  }\n\n  ngOnInit() {\n    console.log('ProfilePage initialized');\n    this.profileForm = this.fb.group({\n      displayName: ['']\n    });\n\n    this.profileForm.get('displayName').valueChanges.subscribe(value => {\n      this.saveProfile();\n    });\n  }\n\n  ngOnDestroy() {\n    console.log('ProfilePage destroyed');\n    // Clean up any subscriptions or listeners if necessary\n  }\n\n  async logout() {\n    await this.authService.logout();\n    this.router.navigateByUrl('/', { replaceUrl: true });\n  }\n\n  goBack() {\n    // Use the router to navigate back\n    this.router.navigate(['/home']); // Replace '/previous-page' with your desired route\n  }\n\n  async presentImageSourceActionSheet() {\n    const actionSheet = await this.actionSheetController.create({\n      header: 'Select Image Source',\n      buttons: [\n        {\n          text: 'Camera',\n          icon: 'camera',\n          handler: () => {\n            this.changeImage(CameraSource.Camera);\n          }\n        },\n        {\n          text: 'Gallery',\n          icon: 'images',\n          handler: () => {\n            this.changeImage(CameraSource.Photos);\n          }\n        },\n        {\n          text: 'File',\n          icon: 'document',\n          handler: () => {\n            this.selectFile();\n          }\n        },\n        {\n          text: 'Cancel',\n          icon: 'close',\n          role: 'cancel'\n        }\n      ]\n    });\n    await actionSheet.present();\n  }\n\n  async changeImage(source: CameraSource) {\n    try {\n      const image = await Camera.getPhoto({\n        quality: 90,\n        allowEditing: false,\n        resultType: CameraResultType.Base64,\n        source: source,\n      });\n\n      if (image) {\n        const loading = await this.loadingController.create();\n        await loading.present();\n\n        if (!this.avatarService.profile?.uid) {\n          loading.dismiss();\n          const alert = await this.alertController.create({\n            header: 'Upload failed',\n            message: 'Profile UID is missing.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n          return;\n        }\n\n        const result = await this.avatarService.uploadImage(image, this.avatarService.profile.uid);\n        loading.dismiss();\n\n        if (!result) {\n          const alert = await this.alertController.create({\n            header: 'Upload failed',\n            message: 'There was a problem uploading your avatar.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n        } else {\n          const alert = await this.alertController.create({\n            header: 'Upload Successful',\n            message: 'Your avatar has been successfully uploaded.',\n            buttons: ['OK'],\n          });\n          await alert.present();\n\n          // Update the user profile\n          if (this.auth.currentUser) {\n            const result = await this.avatarService.uploadImage(image as Photo, this.avatarService.profile.uid);\n            await updateProfile(this.user, {\n              photoURL: result,\n            });\n            this.user = this.auth.currentUser; // Refresh the user object\n          }\n        }\n      }\n    } catch (error) {\n      const alert = await this.alertController.create({\n        header: 'Upload failed',\n        message: `There was a problem uploading your avatar: ${error.message}`,\n        buttons: ['OK'],\n      });\n      await alert.present();\n    }\n  }\n\n  async selectFile() {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = 'image/*';\n    input.onchange = async (event: any) => {\n      const file = event.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = async (e: any) => {\n          const image = {\n            base64String: e.target.result.split(',')[1]\n          };\n          const loading = await this.loadingController.create();\n          await loading.present();\n\n          if (!this.avatarService.profile?.uid) {\n            loading.dismiss();\n            const alert = await this.alertController.create({\n              header: 'Upload failed',\n              message: 'Profile UID is missing.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n            return;\n          }\n\n          const result = await this.avatarService.uploadImage(image as Photo, this.avatarService.profile.uid);\n          loading.dismiss();\n\n          if (!result) {\n            const alert = await this.alertController.create({\n              header: 'Upload failed',\n              message: 'There was a problem uploading your avatar.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n          } else {\n            const alert = await this.alertController.create({\n              header: 'Upload Successful',\n              message: 'Your avatar has been successfully uploaded.',\n              buttons: ['OK'],\n            });\n            await alert.present();\n\n            // Update the user profile\n            if (this.auth.currentUser) {\n              await updateProfile(this.user, {\n                photoURL: result,\n              });\n              this.user = this.auth.currentUser; // Refresh the user object\n            }\n          }\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    input.click();\n  }\n\n  async saveProfile() {\n    if (this.user) {\n      const userDocRef = doc(this.avatarService.firestore, `Riders/${this.user.uid}`);\n      //const loading = await this.loadingController.create();\n      //await loading.present();\n\n      try {\n        await updateProfile(this.user, {\n          displayName: this.profileForm.get('displayName').value,\n        });\n        //loading.dismiss();\n        // const alert = await this.alertController.create({\n        //   header: 'Profile Updated',\n        //   message: 'Your profile information has been updated.',\n        //   buttons: ['OK'],\n        // });\n        // await alert.present();\n      } catch (error) {\n        // loading.dismiss();\n        // const alert = await this.alertController.create({\n        //   header: 'Update Failed',\n        //   message: 'There was a problem updating your profile.',\n        //   buttons: ['OK'],\n        // });\n        // await alert.present();\n      }\n    }\n  }\n}\n","<ion-header class=\"ion-no-border\">\n  <ion-toolbar>\n    <ion-buttons slot=\"start\">\n      <ion-button color=\"primary\" (click)=\"goBack()\">\n        <ion-back-button></ion-back-button>\n      </ion-button>\n    </ion-buttons>\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"logout()\">\n        <ion-icon slot=\"icon-only\" name=\"log-out\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>My Profile</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <div *ngIf=\"user; else loading\">\n    <div class=\"preview\">\n      <ion-avatar (click)=\"presentImageSourceActionSheet()\">\n        <img *ngIf=\"user.photoURL; else placeholder_avatar;\" [src]=\"user.photoURL\" />\n        <ng-template #placeholder_avatar>\n          <div class=\"fallback\">\n            <p>Select avatar</p>\n          </div>\n        </ng-template>\n      </ion-avatar>\n    </div>\n\n    <form [formGroup]=\"profileForm\">\n      <ion-item class=\"ion-margin\">\n        <ion-icon name=\"call\" color=\"primary\" slot=\"start\"></ion-icon>\n        <ion-label>\n          {{ user.phoneNumber || 'No phone number' }}\n        </ion-label>\n      </ion-item>\n\n      <ion-item class=\"ion-margin\">\n        <ion-icon name=\"person\" color=\"primary\" slot=\"start\"></ion-icon>\n        <ion-input formControlName=\"displayName\" placeholder=\"Name\"></ion-input>\n      </ion-item>\n\n      <ion-item class=\"ion-margin\">\n        <ion-icon name=\"mail\" color=\"primary\" slot=\"start\"></ion-icon>\n        <ion-label>\n          {{ user.email || 'No email' }}\n        </ion-label>\n      </ion-item>\n    </form>\n\n    <ion-label color=\"primary\" class=\"ion-text-center ion-padding-top\">\n      <p>Ride receipts will be sent to your email.</p>\n    </ion-label>\n  </div>\n\n  <ng-template #loading>\n    <ion-spinner></ion-spinner>\n    <p>Loading profile...</p>\n  </ng-template>\n</ion-content>\n"],"names":["updateProfile","Camera","CameraResultType","CameraSource","doc","i0","_r4","ProfilePage","constructor","avatarService","authService","router","loadingController","alertController","auth","actionSheetController","fb","onAuthStateChanged","user","profileForm","patchValue","displayName","profile","ngOnInit","console","log","group","get","valueChanges","subscribe","value","saveProfile","ngOnDestroy","logout","navigateByUrl","replaceUrl","goBack","navigate","presentImageSourceActionSheet","actionSheet","create","header","buttons","text","icon","handler","changeImage","Photos","selectFile","role","present","source","image","getPhoto","quality","allowEditing","resultType","Base64","loading","uid","dismiss","alert","message","result","uploadImage","currentUser","photoURL","error","input","document","createElement","type","accept","onchange","event","file","target","files","reader","FileReader","onload","e","base64String","split","readAsDataURL","click","userDocRef","firestore","selectors","decls","vars","consts","template","ctx","_r1"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}